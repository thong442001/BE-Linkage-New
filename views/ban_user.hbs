<h1>Danh sách các tài khoản bị khóa</h1>
<div class="container">
    {{#each report_user_list}}
    <div class="report-post-tong">
        <div class="report-post">
            <!-- Cột 1: Bài Post -->
            <div class="post-content">
                <h4>Tài khoản:</h4>
                <div class="post-header">
                    <img class="avatar" src="{{ID_user.avatar}}" alt="User Avatar">
                    <div>
                        <h4>{{ID_user.first_name}} {{ID_user.last_name}}</h4>
                        {{!-- <p>{{formatDate ID_post.createdAt}}</p> --}}
                    </div>

                </div>
                {{!-- <img class="avatar" src="{{ID_user.background}}" alt="User Avatar"> --}}
            </div>

            <!-- Cột 2: Danh sách reporters -->
            <div class="reporters-list">
                <h4>Những tài khoản báo cáo:</h4>
                <ul>
                    {{#each reporters}}
                    <li class="reporter">
                        <img class="avatar-small" src="{{this.avatar}}" alt="Reporter Avatar">
                        <span>{{this.first_name}} {{this.last_name}}</span>
                    </li>
                    {{/each}}
                </ul>
            </div>
        </div>

        <div class="report-action">
            <button class="unban" data-report-id="{{_id}}">Mở khóa</button>
        </div>
    </div>
    {{/each}}
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".unban").forEach(button => {
            button.addEventListener("click", async function () {
                const reportUserId = this.getAttribute("data-report-id");

                if (!confirm("Bạn có chắc muốn khóa tài khoản này?")) return;

                try {
                    const response = await fetch("/report_user/banUser", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({ ID_report_user: reportUserId }),
                    });

                    const result = await response.json();

                    if (result.status) {
                        alert("Tài khoản đã bị khóa.");
                        this.closest(".report-post-tong").remove(); // Xóa bài bị khóa khỏi giao diện
                    } else {
                        alert("Lỗi: " + result.message);
                    }
                } catch (error) {
                    console.error("Lỗi khi gửi yêu cầu:", error);
                    alert("Có lỗi xảy ra, vui lòng thử lại.");
                }
            });
        });
    });
</script>